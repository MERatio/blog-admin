(this["webpackJsonpblog-admin"]=this["webpackJsonpblog-admin"]||[]).push([[0],{46:function(e,t,n){},48:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var a=n(31),s=n.n(a),r=n(1),c=n.n(r),i=n(32),o=n.n(i),l=n(8),u=(n(43),n(44),n(46),n(2)),p=n.n(u),d=n(3),b=n(5),j=n(4),m=n(6),h=n(36);function f(){return x.apply(this,arguments)}function x(){return(x=Object(d.a)(p.a.mark((function e(){var t,n,a=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"",e.prev=1,e.next=4,fetch(t,{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("jwt"))}});case 4:return n=e.sent,e.abrupt("return",n.json());case 8:e.prev=8,e.t0=e.catch(1),window.flashes([{msg:"Something went wrong, please try again later."}]);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function O(e){return v.apply(this,arguments)}function v(){return(v=Object(d.a)(p.a.mark((function e(t){var n,a,s,r=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"",a=r.length>2&&void 0!==r[2]?r[2]:{},e.prev=2,e.next=5,fetch(n,{method:t,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("jwt"))},body:JSON.stringify(a)});case 5:return s=e.sent,e.abrupt("return",s.json());case 9:e.prev=9,e.t0=e.catch(2),window.flashes([{msg:"Something went wrong, please try again later."}]);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function g(e){return w.apply(this,arguments)}function w(){return(w=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("PUT","".concat("https://blog-api-97575.herokuapp.com","/posts/").concat(t._id),Object(b.a)(Object(b.a)({},t),{},{published:!t.published}));case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function y(e,t){return N.apply(this,arguments)}function N(){return(N=Object(d.a)(p.a.mark((function e(t,n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("https://blog-api-97575.herokuapp.com","/posts/").concat(t,"/comments/").concat(n),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("jwt"))}});case 3:return a=e.sent,e.abrupt("return",a.json());case 7:e.prev=7,e.t0=e.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function k(e){window.flashes([{msg:e.message}])}var S=n(33),P=new(n.n(S).a),C=(n(48),n(0));var F=function(e){var t=e.type,n=e.size;return Object(C.jsx)("div",{className:"BootstrapSpinner",children:Object(C.jsx)("div",{className:"spinner-".concat(t," text-primary"),style:{width:n,height:n},role:"status",children:Object(C.jsx)("span",{className:"sr-only",children:"Loading..."})})})};var D=function(e){var t=e.user,n=e.signOut;return Object(C.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary sticky-top mb-4",children:[Object(C.jsx)(l.c,{to:"/",className:"navbar-brand",children:"Blog User"}),Object(C.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(C.jsx)("span",{className:"navbar-toggler-icon"})}),Object(C.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:Object(C.jsx)("ul",{className:"navbar-nav ml-auto",children:t?Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("li",{className:"nav-item",children:Object(C.jsx)(l.c,{exact:!0,to:"/posts",className:"nav-link",activeClassName:"active",children:"Posts"})}),Object(C.jsx)("li",{className:"nav-item",children:Object(C.jsx)(l.c,{exact:!0,to:"/posts/new",className:"nav-link",activeClassName:"active",children:"Add a new post"})}),Object(C.jsxs)("li",{className:"nav-item dropdown",children:[Object(C.jsx)("button",{className:"nav-link btn btn-link dropdown-toggle",id:"navbarDropdown","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:t.username}),Object(C.jsx)("div",{className:"dropdown-menu dropdown-menu-right",children:Object(C.jsx)("button",{className:"dropdown-item",type:"button",onClick:n,children:"Sign out"})})]})]}):Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("li",{className:"nav-item",children:Object(C.jsx)(l.c,{exact:!0,to:"/sign-up",className:"nav-link",activeClassName:"active",children:"Sign Up"})}),Object(C.jsx)("li",{className:"nav-item",children:Object(C.jsx)(l.c,{exact:!0,to:"/sign-in",className:"nav-link",activeClassName:"active",children:"Sign In"})})]})})})]})};var L=function(e){var t=e.flashes,n=e.onFlashDelete;return Object(C.jsx)(C.Fragment,{children:t.map((function(e){return Object(C.jsxs)("div",{className:"alert alert-".concat(e.type||"danger"," alert-dismissible"),role:"alert",children:[e.msg,Object(C.jsx)("button",{type:"button",className:"close","aria-label":"Close",onClick:function(){return n(e.id)},children:Object(C.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]},e.id)}))})},T=function(){var e=Object(r.useState)(!1),t=Object(j.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){return a(!0),function(){return a(!1)}}),[]),n},I=n(15),U=n.n(I),E=n(18),_=n.n(E),q=n(35),B=n.n(q);var z=function(e){var t=e.type,n=e.text,a=e.isLoading,s=e.loadingText,r=e.onClick;return a?Object(C.jsxs)("button",{type:"button",className:"btn btn-".concat(t),disabled:!0,children:[Object(C.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),s]}):Object(C.jsx)("button",{type:"button",className:"btn btn-".concat(t),onClick:r,children:n})};var A=function(e){var t=e.post,n=e.handlePostPublishedUpdate,a=e.postCommentsLength,s=T(),c=Object(r.useState)(!1),i=Object(j.a)(c,2),o=i[0],u=i[1];function b(){return(b=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,n(t);case 3:s&&u(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(C.jsxs)("article",{className:"card mb-2",children:[Object(C.jsxs)("div",{className:"card-header d-flex justify-content-between",children:[Object(C.jsxs)("div",{children:[Object(C.jsx)("h5",{className:"card-title",children:t.title}),Object(C.jsx)("p",{className:"card-subtitle mb-2",children:t.author.firstName+" "+t.author.lastName}),Object(C.jsx)("p",{className:"card-subtitle",children:_()(new Date(t.createdAt),"PPpp")})]}),Object(C.jsxs)("div",{children:[Object(C.jsx)(z,{type:t.published?"danger":"warning",text:t.published?"Unpublish":"Publish",isLoading:o,loadingText:"Updating...",onClick:function(){return b.apply(this,arguments)}}),Object(C.jsx)(l.b,{to:"/posts/".concat(t._id,"/edit"),className:"ml-3",children:"Edit"})]})]}),Object(C.jsxs)("div",{className:"card-body",children:[Object(C.jsx)("p",{className:"card-text",children:t.body}),Object(C.jsx)(l.b,{to:"/posts/".concat(t._id),className:"card-link",children:B()("comments",t.comments?t.comments.length:a,!0)})]})]})};function J(e){var t=e.posts,n=e.handlePostPublishedUpdate,a=t.map((function(e){return Object(C.jsx)(A,{post:e,handlePostPublishedUpdate:n},e._id)}));return Object(C.jsx)(C.Fragment,{children:a})}J.propTypes={posts:U.a.array.isRequired,handlePostPublishedUpdate:U.a.func.isRequired};var H=J;var R=function(){var e=T(),t=Object(r.useState)([]),n=Object(j.a)(t,2),a=n[0],s=n[1],c=Object(r.useState)(!1),i=Object(j.a)(c,2),o=i[0],l=i[1];function u(){return(u=Object(d.a)(p.a.mark((function t(n){var a,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g(n);case 2:(a=t.sent).err?k(a.err):a.errors?window.flashes(a.errors):(r=a.post,e&&r._id&&s((function(e){return e.map((function(e){return e._id!==n._id?e:Object(b.a)(Object(b.a)({},e),{},{published:r.published})}))})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(r.useEffect)((function(){function t(){return(t=Object(d.a)(p.a.mark((function t(){var n,a,r,c,i,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=function(){return(c=Object(d.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(t.map(function(){var e=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("".concat("https://blog-api-97575.herokuapp.com","/posts/").concat(t._id,"/comments"));case 3:if(!(n=e.sent).err){e.next=8;break}k(n.err),e.next=9;break;case 8:return e.abrupt("return",Object(b.a)(Object(b.a)({},t),{},{comments:n.comments}));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()));case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)},r=function(e){return c.apply(this,arguments)},a=function(){return(a=Object(d.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("".concat("https://blog-api-97575.herokuapp.com","/posts"));case 3:if(!(t=e.sent).err){e.next=8;break}k(t.err),e.next=9;break;case 8:return e.abrupt("return",t.posts);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)},n=function(){return a.apply(this,arguments)},!e){t.next=14;break}return l(!0),t.next=8,n();case 8:return i=t.sent,t.next=11,r(i);case 11:o=t.sent,l(!1),s(o);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e]),o?Object(C.jsx)("div",{className:"position-relative",style:{minHeight:"30em"},children:Object(C.jsx)(F,{type:"border",size:"2em"})}):Object(C.jsx)(H,{posts:a,handlePostPublishedUpdate:function(e){return u.apply(this,arguments)}})};var Y=function(){return Object(C.jsx)("div",{className:"container",children:Object(C.jsx)("div",{className:"row justify-content-center",children:Object(C.jsx)("div",{className:"col-md-8",children:Object(C.jsx)("section",{children:Object(C.jsx)(R,{})})})})})},G=n(14);function M(e){var t=e.text;return e.isSubmitting?Object(C.jsxs)("button",{type:"submit",className:"btn btn-primary w-100",disabled:!0,children:[Object(C.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Submitting..."]}):Object(C.jsx)("button",{type:"submit",className:"btn btn-primary w-100",children:t})}M.defaultProps={text:"Submit"};var Z=M;var $=function(e){var t=e.state,n=e.onInputChange,a=e.onSubmit,s=e.isSubmitting,r=e.submitBtnText;return Object(C.jsxs)("form",{onSubmit:a,children:[Object(C.jsxs)("div",{className:"form-group",children:[Object(C.jsx)("label",{htmlFor:"title",children:"Title"}),Object(C.jsx)("textarea",{className:"form-control",id:"title",name:"title",value:t.title,onChange:n,required:!0,maxLength:70})]}),Object(C.jsxs)("div",{className:"form-group",children:[Object(C.jsx)("label",{htmlFor:"body",children:"Body"}),Object(C.jsx)("textarea",{className:"form-control",id:"body",name:"body",value:t.body,onChange:n,required:!0,maxLength:1e3})]}),Object(C.jsxs)("div",{className:"form-group form-check",children:[Object(C.jsx)("input",{type:"checkbox",className:"form-check-input",id:"published",name:"published",checked:t.published,onChange:n}),Object(C.jsx)("label",{className:"form-check-label",htmlFor:"published",children:"Published?"})]}),Object(C.jsx)(Z,{text:r,isSubmitting:s})]})};var K=function(){var e=T(),t=Object(r.useState)({title:"",body:"",published:!1}),n=Object(j.a)(t,2),a=n[0],s=n[1],c=Object(r.useState)(!1),i=Object(j.a)(c,2),o=i[0],l=i[1];function u(){return(u=Object(d.a)(p.a.mark((function t(n){var r,c,i,o,u;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n.preventDefault(),l(!0),t.next=5,O("POST","".concat("https://blog-api-97575.herokuapp.com","/posts"),a);case 5:r=t.sent,e&&l(!1),r.err?k(r.err):r.errors?(c=r.post,i=c.title,o=c.body,u=c.published,e&&s({title:i,body:o,published:u}),window.flashes(r.errors)):(s({title:"",body:"",published:!1}),window.flashes([{msg:"Post successfully created",type:"success"}])),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}return Object(C.jsx)("div",{className:"container",children:Object(C.jsx)("div",{className:"row justify-content-center",children:Object(C.jsx)("div",{className:"col-md-8",children:Object(C.jsx)("section",{children:Object(C.jsx)($,{state:a,onInputChange:function(e){var t=e.target,n=t.name,a="checkbox"===t.type?t.checked:t.value;s((function(e){return Object(b.a)(Object(b.a)({},e),{},Object(G.a)({},n,a))}))},onSubmit:function(e){return u.apply(this,arguments)},isSubmitting:o,submitBtnText:"Submit"})})})})})};var Q=function(){var e=Object(m.h)().postId,t=Object(m.g)(),n=T(),a=Object(r.useState)(!1),s=Object(j.a)(a,2),c=s[0],i=s[1],o=Object(r.useState)({title:"",body:"",published:!1}),l=Object(j.a)(o,2),u=l[0],h=l[1],x=Object(r.useState)(!1),v=Object(j.a)(x,2),g=v[0],w=v[1];function y(){return(y=Object(d.a)(p.a.mark((function a(s){var r,c,i,o,l;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,s.preventDefault(),w(!0),a.next=5,O("PUT","".concat("https://blog-api-97575.herokuapp.com","/posts/").concat(e),u);case 5:r=a.sent,n&&w(!1),r.err?k(r.err):r.errors?(c=r.post,i=c.title,o=c.body,l=c.published,n&&h({title:i,body:o,published:l}),window.flashes(r.errors)):(h({title:"",body:"",published:!1}),t.push("/"),window.flashes([{msg:"Post successfully updated",type:"success"}])),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){function n(){return(n=Object(d.a)(p.a.mark((function e(n){var a,s,r,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i(!0),e.next=4,f("".concat("https://blog-api-97575.herokuapp.com","/posts/").concat(n,"/edit"));case 4:a=e.sent,i(!1),a.err?([401,404].includes(a.err.status)&&t.push("/"),k(a)):(s=a.post,r=s.title,c=s.body,o=s.published,h({title:r,body:c,published:o})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}!function(e){n.apply(this,arguments)}(e)}),[e,t]),c?Object(C.jsx)("div",{className:"bootstrap-spinner-container",children:Object(C.jsx)(F,{type:"border",size:"2em"})}):u.title?Object(C.jsx)("div",{className:"container",children:Object(C.jsx)("div",{className:"row justify-content-center",children:Object(C.jsx)("div",{className:"col-md-8",children:Object(C.jsx)("section",{children:Object(C.jsx)($,{state:u,onInputChange:function(e){var t=e.target,n=t.name,a="checkbox"===t.type?t.checked:t.value;h((function(e){return Object(b.a)(Object(b.a)({},e),{},Object(G.a)({},n,a))}))},onSubmit:function(e){return y.apply(this,arguments)},isSubmitting:g,submitBtnText:"Update"})})})})}):null};var V=function(e){var t=e.postId,n=e.postCommentsLength,a=Object(m.g)(),s=T(),c=Object(r.useState)(!1),i=Object(j.a)(c,2),o=i[0],l=i[1],u=Object(r.useState)({}),b=Object(j.a)(u,2),h=b[0],x=b[1];function O(){return(O=Object(d.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:(n=e.sent).err?k(n.err):n.errors?window.flashes(n.errors):(a=n.post,s&&a._id&&x(a));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){function e(){return(e=Object(d.a)(p.a.mark((function e(t){var n,s,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(){return(s=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("".concat("https://blog-api-97575.herokuapp.com","/posts/").concat(t));case 3:if(!(n=e.sent).err){e.next=9;break}[401,404].includes(n.err.status)&&a.push("/"),k(n.err),e.next=10;break;case 9:return e.abrupt("return",n.post);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)},n=function(e){return s.apply(this,arguments)},l(!0),e.next=5,n(t);case 5:r=e.sent,l(!1),x(r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s&&function(t){e.apply(this,arguments)}(t)}),[a,s,t]),o?Object(C.jsx)("div",{className:"position-relative",style:{minHeight:"30em"},children:Object(C.jsx)(F,{type:"border",size:"2em"})}):h._id?Object(C.jsx)(A,{post:h,handlePostPublishedUpdate:function(e){return O.apply(this,arguments)},postCommentsLength:n}):null};var W=function(e){var t=e.postComment,n=e.handlePostCommentDelete,a=T(),s=Object(r.useState)(!1),c=Object(j.a)(s,2),i=c[0],o=c[1];function l(){return(l=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,n(t.post._id,t._id);case 3:a&&o(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(C.jsxs)("li",{className:"list-group-item d-flex justify-content-between",children:[Object(C.jsxs)("div",{children:[Object(C.jsx)("p",{className:"h6 mb-1",children:t.author.firstName+" "+t.author.lastName}),Object(C.jsx)("p",{className:"text-muted mb-2",children:_()(new Date(t.createdAt),"PPpp")}),Object(C.jsx)("p",{className:"mb-2",children:t.body})]}),Object(C.jsx)("div",{children:Object(C.jsx)(z,{type:"danger",text:"Delete",isLoading:i,loadingText:"Deleting...",onClick:function(){return l.apply(this,arguments)}})})]})};var X=function(e){var t=e.postComments,n=e.handlePostCommentDelete;return t.length>0?Object(C.jsx)("ul",{className:"list-group",children:t.map((function(e){return Object(C.jsx)(W,{postComment:e,handlePostCommentDelete:n},e._id)}))}):null};var ee=function(){var e=Object(m.g)(),t=Object(m.h)().postId,n=T(),a=Object(r.useState)(!1),s=Object(j.a)(a,2),c=s[0],i=s[1],o=Object(r.useState)([]),l=Object(j.a)(o,2),u=l[0],b=l[1];function h(e){return x.apply(this,arguments)}function x(){return(x=Object(d.a)(p.a.mark((function t(n){var a,s,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=function(){return(s=Object(d.a)(p.a.mark((function t(n){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f("".concat("https://blog-api-97575.herokuapp.com","/posts/").concat(n,"/comments"));case 3:if(!(a=t.sent).err){t.next=9;break}[401,404].includes(a.err.status)&&e.push("/"),k(a.err),t.next=10;break;case 9:return t.abrupt("return",a.comments);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)},a=function(e){return s.apply(this,arguments)},i(!0),t.next=5,a(n);case 5:r=t.sent,i(!1),b(r);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(){return(O=Object(d.a)(p.a.mark((function e(t,n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t,n);case 2:if(!(a=e.sent).err){e.next=7;break}k(a.err),e.next=9;break;case 7:return e.next=9,h(t);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){n&&h(t)}),[n,t]),Object(C.jsx)("div",{className:"container",children:Object(C.jsx)("div",{className:"row justify-content-center",children:Object(C.jsx)("div",{className:"col-md-8 position-relative",children:Object(C.jsxs)("section",{children:[Object(C.jsx)(V,{postId:t,postCommentsLength:u.length}),c?Object(C.jsx)("div",{className:"position-relative",style:{minHeight:"10em"},children:Object(C.jsx)(F,{type:"border",size:"2em"})}):Object(C.jsx)(X,{postComments:u,handlePostCommentDelete:function(e,t){return O.apply(this,arguments)}})]})})})})};var te=function(){var e=Object(m.g)(),t=T(),n=Object(r.useState)({firstName:"",lastName:"",username:"",password:"",confirmPassword:"",adminPasscode:""}),a=Object(j.a)(n,2),s=a[0],c=a[1],i=Object(r.useState)(!1),o=Object(j.a)(i,2),l=o[0],u=o[1];function h(e){var t=e.target,n=t.name,a=t.value;c((function(e){return Object(b.a)(Object(b.a)({},e),{},Object(G.a)({},n,a))}))}function f(){return(f=Object(d.a)(p.a.mark((function n(a){var r;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a.preventDefault(),u(!0),n.next=5,O("POST","".concat("https://blog-api-97575.herokuapp.com","/users"),Object(b.a)(Object(b.a)({},s),{},{isAdminPasscodeRequired:!0}));case 5:r=n.sent,t&&u(!1),r.err?k(r.err):r.errors?(t&&c({firstName:r.userFormData.firstName,lastName:r.userFormData.lastName,username:r.userFormData.username,password:"",confirmPassword:"",adminPasscode:""}),window.flashes(r.errors)):(window.flashes([{msg:"You have successfuly signed up",type:"success"}]),e.push("/")),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 13:case"end":return n.stop()}}),n,null,[[0,10]])})))).apply(this,arguments)}return Object(C.jsxs)("form",{onSubmit:function(e){return f.apply(this,arguments)},children:[Object(C.jsxs)("div",{className:"form-group",children:[Object(C.jsx)("label",{htmlFor:"firstName",children:"First name"}),Object(C.jsx)("input",{type:"text",className:"form-control",id:"firstName",placeholder:"John",name:"firstName",value:s.firstName,required:!0,maxLength:"255",onChange:h})]}),Object(C.jsxs)("div",{className:"form-group",children:[Object(C.jsx)("label",{htmlFor:"lastName",children:"Last name"}),Object(C.jsx)("input",{type:"text",className:"form-control",id:"lastName",placeholder:"Doe",name:"lastName",value:s.lastName,required:!0,maxLength:"255",onChange:h})]}),Object(C.jsxs)("div",{className:"form-group",children:[Object(C.jsx)("label",{htmlFor:"username",children:"Username"}),Object(C.jsx)("input",{type:"text",className:"form-control",id:"username",placeholder:"johnDoe01",name:"username",value:s.username,required:!0,pattern:"^[a-zA-Z0-9-_]+$",title:"Username can only contain letters, numbers, - and _'",maxLength:"20",onChange:h})]}),Object(C.jsxs)("div",{className:"form-group",children:[Object(C.jsx)("label",{htmlFor:"password",children:"Password"}),Object(C.jsx)("input",{type:"password",className:"form-control",id:"password",name:"password",value:s.password,required:!0,minLength:"8",onChange:h})]}),Object(C.jsxs)("div",{className:"form-group",children:[Object(C.jsx)("label",{htmlFor:"confirmPassword",children:"Password confirmation"}),Object(C.jsx)("input",{type:"password",className:"form-control",id:"confirmPassword",name:"confirmPassword",value:s.confirmPassword,required:!0,minLength:"8",onChange:h})]}),Object(C.jsxs)("div",{className:"form-group",children:[Object(C.jsx)("label",{htmlFor:"adminPasscode",children:"Admin passcode"}),Object(C.jsx)("input",{type:"password",className:"form-control",id:"adminPasscode",name:"adminPasscode",value:s.adminPasscode,required:!0,onChange:h})]}),Object(C.jsx)(Z,{isSubmitting:l})]})};var ne=function(){return Object(C.jsx)("div",{className:"container",children:Object(C.jsx)("div",{className:"row justify-content-center",children:Object(C.jsx)("div",{className:"col-md-6",children:Object(C.jsx)("section",{children:Object(C.jsx)(te,{})})})})})};var ae=function(e){var t=e.setUser,n=Object(m.g)(),a=T(),s=Object(r.useState)({username:"",password:""}),c=Object(j.a)(s,2),i=c[0],o=c[1],l=Object(r.useState)(!1),u=Object(j.a)(l,2),h=u[0],f=u[1];function x(e){var t=e.target,n=t.name,a=t.value;o((function(e){return Object(b.a)(Object(b.a)({},e),{},Object(G.a)({},n,a))}))}function v(){return(v=Object(d.a)(p.a.mark((function e(s){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s.preventDefault(),f(!0),e.next=5,O("POST","".concat("https://blog-api-97575.herokuapp.com","/auth/sign-in"),i);case 5:r=e.sent,a&&f(!1),r.err?(a&&o((function(e){return Object(b.a)(Object(b.a)({},e),{},{password:""})})),k(r.err)):r.user&&r.user.admin?(localStorage.setItem("jwt",r.token),t(r.user),window.flashes([{msg:"You have successfuly signed in",type:"success"}]),n.push("/")):(a&&o({username:"",password:""}),window.flashes([{msg:"Admin account is required",type:"warning"}])),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),window.flashes([{msg:"Something went wrong, please try again later."}]);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}return Object(C.jsxs)("form",{onSubmit:function(e){return v.apply(this,arguments)},children:[Object(C.jsxs)("div",{className:"form-group",children:[Object(C.jsx)("label",{htmlFor:"username",children:"Username"}),Object(C.jsx)("input",{type:"text",className:"form-control",id:"username",placeholder:"johnDoe01",name:"username",value:i.username,required:!0,maxLength:"20",onChange:x})]}),Object(C.jsxs)("div",{className:"form-group",children:[Object(C.jsx)("label",{htmlFor:"password",children:"Password"}),Object(C.jsx)("input",{type:"password",className:"form-control",id:"password",name:"password",value:i.password,required:!0,minLength:"8",onChange:x})]}),Object(C.jsx)(Z,{isSubmitting:h})]})};var se=function(e){var t=e.setUser;return Object(C.jsx)("div",{className:"container",children:Object(C.jsx)("div",{className:"row justify-content-center",children:Object(C.jsx)("div",{className:"col-md-6",children:Object(C.jsx)("section",{children:Object(C.jsx)(ae,{setUser:t})})})})})};n(77);var re=function(){var e=Object(m.g)(),t=Object(r.useState)([]),n=Object(j.a)(t,2),a=n[0],s=n[1],c=Object(r.useState)(null),i=Object(j.a)(c,2),o=i[0],l=i[1];return Object(r.useEffect)((function(){P.addListener("flashes",(function(e){var t=e.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{id:Object(h.a)()})}));s(t)}))}),[]),Object(r.useEffect)((function(){window.flashes=function(e){return P.emit("flashes",e)}}),[]),Object(r.useEffect)((function(){if(a.length>0){var e=setTimeout((function(){return s([])}),4e3);return function(){return clearTimeout(e)}}}),[a]),Object(r.useEffect)((function(){function e(){return t.apply(this,arguments)}function t(){return(t=Object(d.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("".concat("https://blog-api-97575.herokuapp.com","/users/current-user"));case 2:(t=e.sent).user&&t.user.admin?l(t.user):(localStorage.removeItem("jwt"),l(!1));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e();var n=setInterval(e,3e4);return function(){return clearInterval(n)}}),[]),null===o?Object(C.jsx)(F,{type:"grow",size:"3em"}):Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(D,{user:o,signOut:function(){localStorage.removeItem("jwt"),l(!1),window.flashes([{msg:"You have successfully signed out",type:"success"}]),e.push("/")}}),a.length>0&&Object(C.jsx)("div",{className:"container",children:Object(C.jsx)("div",{className:"row justify-content-center",children:Object(C.jsx)("div",{className:"col-md-8",children:Object(C.jsx)(L,{flashes:a,onFlashDelete:function(e){var t=a.filter((function(t){return t.id!==e}));s(t)}})})})}),Object(C.jsx)("main",{children:Object(C.jsxs)(m.d,{children:[Object(C.jsx)(m.b,{exact:!0,path:"/",children:Object(C.jsx)(m.a,{to:"/posts"})}),Object(C.jsx)(m.b,{exact:!0,path:"/posts",children:o?Object(C.jsx)(Y,{}):Object(C.jsx)(m.a,{to:"/sign-in"})}),Object(C.jsx)(m.b,{exact:!0,path:"/posts/new",children:o?Object(C.jsx)(K,{}):Object(C.jsx)(m.a,{to:"/sign-in"})}),Object(C.jsx)(m.b,{exact:!0,path:"/posts/:postId",children:o?Object(C.jsx)(ee,{}):Object(C.jsx)(m.a,{to:"/sign-in"})}),Object(C.jsx)(m.b,{exact:!0,path:"/posts/:postId/edit",children:o?Object(C.jsx)(Q,{}):Object(C.jsx)(m.a,{to:"/sign-in"})}),Object(C.jsx)(m.b,{exact:!0,path:"/sign-up",children:o?Object(C.jsx)(m.a,{to:"/"}):Object(C.jsx)(ne,{})}),Object(C.jsx)(m.b,{exact:!0,path:"/sign-in",children:o?Object(C.jsx)(m.a,{to:"/"}):Object(C.jsx)(se,{setUser:l})})]})})]})},ce=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,79)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),s(e),r(e),c(e)}))};s.a.config(),o.a.render(Object(C.jsx)(c.a.StrictMode,{children:Object(C.jsx)(l.a,{basename:"/blog-admin",children:Object(C.jsx)(re,{})})}),document.getElementById("root")),ce()}},[[78,1,2]]]);
//# sourceMappingURL=main.7ac6234c.chunk.js.map